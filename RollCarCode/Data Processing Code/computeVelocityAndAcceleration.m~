function config_with_v_a=computeVelocityAndAcceleration(averagedConfigurations)
    d=4;

    config_with_v_a=averagedConfigurations;
    
    for m=1:length(averagedConfigurations)
        
        config_with_v_a(m).vx_err=averagedConfigurations(m).xerr;
        config_with_v_a(m).vy_err=averagedConfigurations(m).yerr;
        config_with_v_a(m).ax_err=averagedConfigurations(m).xerr;
        config_with_v_a(m).ay_err=averagedConfigurations(m).yerr;
        for n=1:length(averagedConfigurations(m).x)
            config_with_v_a(m).vx{n}=vx;
            config_with_v_a(m).ax{n}=ax;
            [vx,ax]=derivative(averagedConfigurations(m).t{n},averagedConfigurations(m).x{n});
            config_with_v_a(m).vy{n}=vy;
            config_with_v_a(m).ay{n}=ay;
            [vy,ay]=derivative(averagedConfigurations(m).t{n},...
         averagedConfigurations(m).y{n});
        end
    end
end